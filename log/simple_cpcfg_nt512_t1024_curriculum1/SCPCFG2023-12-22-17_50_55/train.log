2023-12-22 17:50:56,419 - INFO - {'device': 'cuda', 'save_dir': 'log/simple_cpcfg_nt512_t1024_curriculum1/SCPCFG2023-12-22-17_50_55', 'data': {'train_file': 'data/ptb-train.pickle', 'val_file': 'data/ptb-val.pickle', 'test_file': 'data/ptb-test.pickle', 'vocab_type': 'max_size', 'vocab_size': 10000, 'min_freq': 2}, 'model': {'model_name': 'SCPCFG', 'NT': 512, 'T': 1024, 's_dim': 512, 'w_dim': 512, 'h_dim': 512, 'z_dim': 64, 'r_dim': -1, 'operation_space': 'normal', 'entropy': False}, 'train': {'batch_size': 16, 'max_epoch': 30, 'max_len': 40, 'curriculum': 1, 'start_len': 30, 'increment': 1, 'patience': 5, 'clip': 3}, 'test': {'batch_size': 16, 'max_tokens': 100, 'bucket': 32, 'decode': 'mbr', 'sampler': 'batch'}, 'optimizer': {'name': 'adam', 'lr': 0.002, 'mu': 0.75, 'nu': 0.999}, 'conf': 'config/simplepcfg/simple_cpcfg_nt512_t1024_curriculum1.yaml'}
2023-12-22 17:50:56,419 - INFO - Create the model
2023-12-22 17:50:56,420 - INFO - Simple_C_PCFG(
  (term_mlp): Sequential(
    (0): Linear(in_features=576, out_features=512, bias=True)
    (1): ResLayer(
      (linear): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=512, bias=True)
        (3): ReLU()
      )
    )
    (2): ResLayer(
      (linear): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=512, bias=True)
        (3): ReLU()
      )
    )
    (3): Linear(in_features=512, out_features=10002, bias=True)
  )
  (left_mlp): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ReLU()
  )
  (right_mlp): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): ReLU()
  )
  (parent_mlp1): Sequential(
    (0): Linear(in_features=576, out_features=512, bias=True)
    (1): ReLU()
  )
  (enc_emb): Embedding(10002, 512)
  (enc_rnn): LSTM(512, 512, batch_first=True, bidirectional=True)
  (enc_out): Linear(in_features=1024, out_features=128, bias=True)
)

2023-12-22 17:50:56,420 - INFO - Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.75, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0
)
2023-12-22 17:50:56,420 - INFO - {'device': 'cuda', 'save_dir': 'log/simple_cpcfg_nt512_t1024_curriculum1/SCPCFG2023-12-22-17_50_55', 'data': {'train_file': 'data/ptb-train.pickle', 'val_file': 'data/ptb-val.pickle', 'test_file': 'data/ptb-test.pickle', 'vocab_type': 'max_size', 'vocab_size': 10000, 'min_freq': 2}, 'model': {'model_name': 'SCPCFG', 'NT': 512, 'T': 1024, 's_dim': 512, 'w_dim': 512, 'h_dim': 512, 'z_dim': 64, 'r_dim': -1, 'operation_space': 'normal', 'entropy': False}, 'train': {'batch_size': 16, 'max_epoch': 30, 'max_len': 40, 'curriculum': 1, 'start_len': 30, 'increment': 1, 'patience': 5, 'clip': 3}, 'test': {'batch_size': 16, 'max_tokens': 100, 'bucket': 32, 'decode': 'mbr', 'sampler': 'batch'}, 'optimizer': {'name': 'adam', 'lr': 0.002, 'mu': 0.75, 'nu': 0.999}, 'conf': 'config/simplepcfg/simple_cpcfg_nt512_t1024_curriculum1.yaml'}
